SELECT COUNT(V.VISIT_ID) AS COUNT_NO_TRANS , CUSTOMER_ID
FROM VISITS V
LEFT OUTER JOIN TRANSACTIONS T
ON V.VISIT_ID = T.VISIT_ID
WHERE T.VISIT_ID IS NULL
GROUP BY CUSTOMER_ID
